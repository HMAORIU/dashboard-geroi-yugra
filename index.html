<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ì–µ—Ä–æ–∏ –Æ–≥—Ä—ã ‚Äî –î–∞—à–±–æ—Ä–¥ —Å Yandex GPT</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- html2canvas –∏ jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f8f9fa;
      color: #212529;
    }
    .navbar {
      background-color: #002B7A;
    }
    .navbar-brand, .nav-link {
      color: white !important;
    }
    .card {
      border: none;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      background-color: white;
    }
    .card-header {
      background-color: #003A9B;
      color: white;
      font-weight: bold;
      border-radius: 12px 12px 0 0 !important;
    }
    .section-title {
      color: #002B7A;
      text-align: center;
      margin: 40px 0 20px;
      font-weight: 700;
    }
    .tag {
      display: inline-block;
      background: #d1e7ff;
      border: 1px solid #0056b3;
      border-radius: 6px;
      padding: 6px 12px;
      margin: 4px;
      font-size: 0.9rem;
      transition: transform 0.2s;
    }
    .tag:hover {
      transform: scale(1.05);
      background: #cce5ff;
    }
    .footer {
      text-align: center;
      margin-top: 50px;
      color: #6c757d;
      font-size: 0.9rem;
    }
    #fileInput {
      display: none;
    }
    .drop-zone {
      border: 3px dashed #007BFF;
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      background-color: #e9ecef;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-bottom: 20px;
    }
    .drop-zone:hover {
      background-color: #dde5f0;
    }
    .drop-zone.success {
      border-color: #28a745;
      background-color: #d4edda;
    }
    .drop-zone.success .upload-text {
      display: none;
    }
    .drop-zone.success .checkmark {
      display: block;
    }
    .checkmark {
      display: none;
      font-size: 48px;
      color: #28a745;
      font-weight: bold;
    }
    .progress-container {
      margin-top: 10px;
      display: none;
    }
    .btn-export {
      margin: 5px;
    }
    .ai-category {
      font-weight: 500;
      color: #003A9B;
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container">
      <a class="navbar-brand" href="#">üìä –ì–µ—Ä–æ–∏ –Æ–≥—Ä—ã ‚Äî —Å Yandex GPT</a>
    </div>
  </nav>

  <div class="container mt-4">
    <h1 class="text-center my-4" style="color: #002B7A;">–ê–Ω–∞–ª–∏–∑ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –°–í–û</h1>
    <p class="text-center text-muted">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–û–±—Ä–∞–±–æ—Ç–∞—Ç—å¬ª</p>

    <!-- Drag & Drop Zone -->
    <div class="drop-zone" id="dropZone">
      <p class="upload-text">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å <strong>–∞–Ω–∫–µ—Ç—ã.xlsx</strong></p>
      <div class="checkmark">‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω</div>
      <input type="file" id="fileInput" accept=".xlsx, .xls" />
    </div>

    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å -->
    <div class="progress-container" id="progressContainer">
      <div class="progress">
        <div class="progress-bar progress-bar-striped progress-bar-animated" id="progressBar" style="width: 0%"></div>
      </div>
      <p class="text-center mt-2">–ò–¥—ë—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ -->
    <div class="text-center">
      <button id="processBtn" class="btn btn-success btn-lg" disabled>üöÄ –û–±—Ä–∞–±–æ—Ç–∞—Ç—å</button>
    </div>

    <!-- –î–∞—à–±–æ—Ä–¥ -->
    <div id="dashboard" style="display: none;">

      <!-- –ü–æ–∏—Å–∫ -->
      <div class="card">
        <div class="card-body">
          <div class="row">
            <div class="col-md-3">
              <input type="text" id="searchFio" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –§–ò–û">
            </div>
            <div class="col-md-3">
              <input type="text" id="searchCity" class="form-control" placeholder="–ì–æ—Ä–æ–¥">
            </div>
            <div class="col-md-3">
              <input type="text" id="searchBranch" class="form-control" placeholder="–†–æ–¥ –≤–æ–π—Å–∫">
            </div>
            <div class="col-md-3">
              <input type="text" id="searchPosition" class="form-control" placeholder="–î–æ–ª–∂–Ω–æ—Å—Ç—å">
            </div>
          </div>
        </div>
      </div>

      <!-- –≠–∫—Å–ø–æ—Ä—Ç -->
      <div class="text-center mb-3">
        <button id="exportExcel" class="btn btn-outline-primary btn-export">üì• Excel</button>
        <button id="exportPdf" class="btn btn-outline-danger btn-export">üìÑ PDF</button>
      </div>

      <!-- –¢–∞–±–ª–∏—Ü–∞ -->
      <div class="card">
        <div class="card-header">–£—á–∞—Å—Ç–Ω–∏–∫–∏ –°–í–û</div>
        <div class="card-body">
          <table class="table table-striped" id="participantsTable">
            <thead>
              <tr>
                <th>–§–ò–û</th>
                <th>–ì–æ—Ä–æ–¥</th>
                <th>–í–æ–∑—Ä–∞—Å—Ç</th>
                <th>–†–æ–¥ –≤–æ–π—Å–∫</th>
                <th>–î–æ–ª–∂–Ω–æ—Å—Ç—å</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∏ -->
      <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#charts">–ì—Ä–∞—Ñ–∏–∫–∏</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#ai">AI-–∞–Ω–∞–ª–∏–∑ –º–æ—Ç–∏–≤–∞—Ü–∏–π</button>
        </li>
      </ul>

      <div class="tab-content mt-3">
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="tab-pane fade show active" id="stats">
          <div class="row">
            <div class="col-md-3">
              <div class="card text-center">
                <div class="card-body">
                  <h5>–í—Å–µ–≥–æ</h5>
                  <h2 id="total" style="color: #002B7A;">0</h2>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card text-center">
                <div class="card-body">
                  <h5>–° –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏</h5>
                  <h2 id="withDocs" style="color: #D9534F;">0</h2>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card text-center">
                <div class="card-body">
                  <h5>–°—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç</h5>
                  <h2 id="avgAge">‚Äî</h2>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card text-center">
                <div class="card-body">
                  <h5>–í—ã—Å—à–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</h5>
                  <h2 id="highEdu">0</h2>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- –ì—Ä–∞—Ñ–∏–∫–∏ -->
        <div class="tab-pane fade" id="charts">
          <div class="row">
            <div class="col-md-6"><canvas id="docsChart"></canvas></div>
            <div class="col-md-6"><canvas id="eduChart"></canvas></div>
          </div>
          <div class="row">
            <div class="col-md-6"><canvas id="citiesChart"></canvas></div>
            <div class="col-md-6"><canvas id="branchChart"></canvas></div>
          </div>
          <div class="row">
            <div class="col-md-6"><canvas id="genderChart"></canvas></div>
            <div class="col-md-6"><canvas id="statusChart"></canvas></div>
          </div>
          <div class="row">
            <div class="col-md-6"><canvas id="maritalChart"></canvas></div>
            <div class="col-md-6"><canvas id="awardsChart"></canvas></div>
          </div>
          <div class="row">
            <div class="col-md-6"><canvas id="expChart"></canvas></div>
            <div class="col-md-6"><canvas id="formationChart"></canvas></div>
          </div>
        </div>

        <!-- AI-–∞–Ω–∞–ª–∏–∑ -->
        <div class="tab-pane fade" id="ai">
          <div class="card">
            <div class="card-header">AI-–∞–Ω–∞–ª–∏–∑ –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º (Yandex GPT)</div>
            <div class="card-body" id="aiTagsContainer">
              <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç GPT -->
            </div>
          </div>
          <div class="card">
            <div class="card-header">–¢–æ–ø-5 –∏–¥–µ–π –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é —Ä–µ–≥–∏–æ–Ω–∞</div>
            <div class="card-body">
              <ol id="aiIdeasList">
                <!-- –ò–¥–µ–∏ –æ—Ç GPT -->
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div class="modal fade" id="detailModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle">–ê–Ω–∫–µ—Ç–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="modalBody"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º JS -->
  <!-- –°–Ω–∞—á–∞–ª–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π xlsx -->
  <script src="libs/xlsx.full.min.js"></script>
  <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- –í–∞—à —Å–∫—Ä–∏–ø—Ç -->
  <script src="assets/js/main.js"></script>
</body>
</html>